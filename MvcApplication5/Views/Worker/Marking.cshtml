@model IEnumerable<MvcApplication5.Models.Document>
@{
    ViewBag.Title = "Marking";
}

<div class="Menu">
    @if (MyRoleProvider.Role(User.Identity.Name, new string[] { "signer" }))
    {
        @Html.ActionLink(" Список документов ", "Index")
        @Html.ActionLink(" Подписать ", "Marking", "Worker")
    }
    @if (MyRoleProvider.Role(User.Identity.Name, new string[] { "author" }))
    {
        @Html.ActionLink(" Список документов ", "Index")
        @Html.ActionLink(" Добавить документ ", "Create")
        @Html.ActionLink(" Испраить документ ", "Marking", "Worker")
    }
</div>

<table>
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.idDocument)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.nameDoc)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.date)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Employee.name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.mark)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Employee1.name)
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
       
            if (item.mark == null && item.Employee1.login == User.Identity.Name && MyRoleProvider.Role(User.Identity.Name, new string[] { "signer" }))
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.idDocument)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.nameDoc)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.date)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Employee.name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.mark)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Employee1.name)
                    </td>
                    <td>
                        <form action="/Worker/Download" method="post">
                            <input name="name" type="hidden" value=@Html.DisplayFor(modelItem => item.nameDoc) />
                            <input type="submit" value="Скачать файл" />
                        </form>

                    </td>
                    <td>
                        @Html.ActionLink("Edit", "Edit", new { id = item.idDocument }) |
                        @Html.ActionLink("Details", "Details", new { id = item.idDocument }) |
                        @Html.ActionLink("Delete", "Delete", new { id = item.idDocument })
                    </td>
                </tr>
            }
    
    }

</table>